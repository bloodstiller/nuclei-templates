id: open-redirect-all-params

info:
  name: Open Redirect - All Query Parameters
  author: NahamSec
  severity: medium
  tags: open-redirect,fuzzing

http:
  - payloads:
      redirect: 
        - "bloodstiller.com"
        - "http://bloodstiller.com"
        - "//////bloodstiller.com"
        - "//bloodstiller%00.com"
        - "@bloodstiller.com"
        - "?www.bloodstiller.com"
        - "/http://bloodstiller.com/"
        

        

    fuzzing:
      - part: query
        mode: single
        fuzz:
          - "https://{{redirect}}"
          - "https://{{hostname}}.{{redirect}}"
          - "https://www.google.com.{{redirect}}"
          - "https://www.youtube.com.{{redirect}}"
          - "http://{{redirect}}"
          - "http://{{hostname}}.{{redirect}}"
          - "http://www.google.com.{{redirect}}"
          - "http://www.youtube.com.{{redirect}}"
          - "{{redirect}}"


    stop-at-first-match: true

    matchers-condition: and
    matchers:
      - type: regex
        part: header
        regex:
          - '(?i)Location\s*:\s*https?:\/\/[a-z0-9\.\-]*bloodstiller\.com.*'

      - type: status
        status:
          - 301
          - 302
          - 307

